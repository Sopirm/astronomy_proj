<% layout('layout') %>
<!-- Astronomical Events Page -->
<div>
  <!-- Header -->
  <div class="text-center mb-8">
    <h1 class="text-4xl font-bold text-gray-900">
      ‚≠ê –ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è
    </h1>
    <p class="text-gray-600 mt-2">–°–æ–±—ã—Ç–∏—è –Ω–∞ –Ω–µ–±–æ—Å–≤–æ–¥–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç AstronomyAPI</p>
  </div>

  <!-- Controls -->
  <div class="space-card rounded-lg p-6 mb-6 shadow-sm">
    <form id="astro-form" class="space-y-4">
      <div class="flex items-center justify-between">
        <h3 class="text-lg font-semibold text-gray-900">üéõÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏—è</h3>
        <button type="submit" 
                class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
          üîç –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
        </button>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <!-- Latitude -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–®–∏—Ä–æ—Ç–∞</label>
          <input type="number" 
                 step="0.0001" 
                 name="lat" 
                 value="55.7558" 
                 class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900"
                 placeholder="55.7558">
        </div>

        <!-- Longitude -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–î–æ–ª–≥–æ—Ç–∞</label>
          <input type="number" 
                 step="0.0001" 
                 name="lon" 
                 value="37.6176" 
                 class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900"
                 placeholder="37.6176">
        </div>

        <!-- Days -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–î–Ω–µ–π –≤–ø–µ—Ä—ë–¥</label>
          <input type="number" 
                 min="1" 
                 max="30" 
                 name="days" 
                 value="7" 
                 class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
        </div>

        <!-- Quick Location -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä</label>
          <select id="quick-location" class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
            <option value="55.7558,37.6176">üèõÔ∏è –ú–æ—Å–∫–≤–∞</option>
            <option value="59.9311,30.3609">üè∞ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
            <option value="40.7128,-74.0060">üóΩ –ù—å—é-–ô–æ—Ä–∫</option>
            <option value="51.5074,-0.1278">üé™ –õ–æ–Ω–¥–æ–Ω</option>
            <option value="48.8566,2.3522">üóº –ü–∞—Ä–∏–∂</option>
            <option value="35.6762,139.6503">üèØ –¢–æ–∫–∏–æ</option>
          </select>
        </div>
      </div>
    </form>
  </div>

  <!-- Loading State -->
  <div id="loading" class="text-center py-12 space-card rounded-lg">
    <div class="loading text-blue-600 text-4xl mb-4">‚≠ê</div>
    <h3 class="text-lg font-semibold text-gray-900">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π...</h3>
    <p class="text-gray-600 mt-2">–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ AstronomyAPI</p>
  </div>

  <!-- Events Table -->
  <div id="events-section" class="space-card rounded-lg p-6" style="display: none;">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-xl font-semibold text-gray-900">üìÖ –ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è</h3>
      <div class="flex items-center space-x-3">
        <span id="events-count" class="text-sm text-gray-600">0 —Å–æ–±—ã—Ç–∏–π</span>
        <button id="export-events" 
                class="px-4 py-2 bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded text-blue-700 text-sm transition-all">
          üì• –≠–∫—Å–ø–æ—Ä—Ç CSV
        </button>
      </div>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead>
          <tr class="border-b border-gray-300">
            <th class="text-left py-3 px-3 text-gray-700">#</th>
            <th class="text-left py-3 px-3 text-gray-700">–û–±—ä–µ–∫—Ç</th>
            <th class="text-left py-3 px-3 text-gray-700">–°–æ–±—ã—Ç–∏–µ</th>
            <th class="text-left py-3 px-3 text-gray-700">–í—Ä–µ–º—è (UTC)</th>
            <th class="text-left py-3 px-3 text-gray-700">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</th>
          </tr>
        </thead>
        <tbody id="events-table-body">
          <tr><td colspan="5" class="text-center py-4 text-gray-600">–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Raw JSON -->
  <div id="raw-section" class="space-card rounded-lg p-6" style="display: none;">
    <details>
      <summary class="cursor-pointer text-gray-600 hover:text-gray-900 mb-4">
        üîç –ü–æ–ª–Ω—ã–π JSON –æ—Ç–≤–µ—Ç
      </summary>
      <pre id="raw-json" class="bg-gray-100 rounded-lg p-4 text-xs overflow-auto max-h-96 text-gray-900"></pre>
    </details>
  </div>

  <!-- Error State -->
  <div id="error-state" class="text-center py-12 space-card rounded-lg" style="display: none;">
    <div class="text-6xl mb-4 text-red-500">‚ö†Ô∏è</div>
    <h3 class="text-xl font-semibold text-gray-900 mb-2">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
    <p id="error-message" class="text-gray-600 mb-4"></p>
    <button class="px-4 py-2 bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded text-blue-700 transition-all"
            onclick="loadEvents()">
      üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
    </button>
  </div>
</div>

<script src="/js/astro-page.js" defer></script>
