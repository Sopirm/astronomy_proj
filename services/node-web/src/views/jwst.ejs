<% layout('layout') %>

<!-- JWST Gallery Page -->
<div class="animate__animated animate__fadeIn">
  <!-- Header -->
  <div class="text-center mb-8">
    <h1 class="text-4xl font-bold text-gray-900">
      üî≠ James Webb Space Telescope
    </h1>
    <p class="text-gray-600 mt-2">–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–∞–º–æ–≥–æ –º–æ—â–Ω–æ–≥–æ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ–ª–µ—Å–∫–æ–ø–∞</p>
  </div>

  <!-- Advanced Filters -->
  <div class="space-card rounded-lg p-6 mb-6 shadow-sm">
    <form id="jwst-filters" class="space-y-4">
      <div class="flex items-center justify-between">
        <h3 class="text-lg font-semibold text-gray-900">üéõÔ∏è –§–∏–ª—å—Ç—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div class="flex items-center space-x-3">
          <div class="text-sm text-gray-600">
            –ü–æ–∫–∞–∑–∞–Ω–æ: <span id="images-count" class="text-blue-600 font-semibold">0</span> –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
          </div>
          <button type="button" id="reset-filters-btn" 
                  class="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-gray-700 text-sm transition-all">
            üîÑ –°–±—Ä–æ—Å
          </button>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- Source Type -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞</label>
          <select name="source" id="source-select" class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
            <option value="jpg" selected>üì∏ –í—Å–µ JPG</option>
            <option value="suffix">üè∑Ô∏è –ü–æ —Å—É—Ñ—Ñ–∏–∫—Å—É</option>
            <option value="program">üöÄ –ü–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ</option>
          </select>
        </div>

        <!-- Suffix Filter -->
        <div id="suffix-filter" style="display: none;">
          <label class="block text-sm font-medium text-gray-700 mb-2">–°—É—Ñ—Ñ–∏–∫—Å</label>
          <input type="text" name="suffix" id="suffix-input" 
                 placeholder="_cal, _thumb, _crf" 
                 class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
        </div>

        <!-- Program Filter -->
        <div id="program-filter" style="display: none;">
          <label class="block text-sm font-medium text-gray-700 mb-2">ID –ø—Ä–æ–≥—Ä–∞–º–º—ã</label>
          <input type="text" name="program" id="program-input" 
                 placeholder="2734, 1345" 
                 class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
        </div>

        <!-- Instrument Filter -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</label>
          <select name="instrument" class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
            <option value="">üî≠ –õ—é–±–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</option>
            <option value="NIRCam">üì∑ NIRCam</option>
            <option value="MIRI">üå°Ô∏è MIRI</option>
            <option value="NIRISS">üî¨ NIRISS</option>
            <option value="NIRSpec">üìä NIRSpec</option>
            <option value="FGS">üéØ FGS</option>
          </select>
        </div>

        <!-- Items per page -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</label>
          <select name="perPage" class="w-full bg-white border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-900">
            <option value="12">12 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</option>
            <option value="24" selected>24 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</option>
            <option value="36">36 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</option>
            <option value="48">48 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</option>
          </select>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex items-center justify-between pt-4 border-t border-gray-300">
        <div class="flex items-center space-x-3">
          <button type="submit" 
                  class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
            üîç –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
          </button>
          
          <button type="button" id="random-images-btn"
                  class="px-4 py-2 bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded-lg text-blue-700 transition-all">
            üé≤ –°–ª—É—á–∞–π–Ω—ã–µ
          </button>
        </div>

        <!-- View Options -->
        <div class="flex items-center space-x-3">
          <span class="text-sm text-gray-700">–í–∏–¥:</span>
          <div class="flex bg-gray-100 rounded-lg p-1">
            <button type="button" id="grid-view" class="px-3 py-1 rounded text-sm bg-blue-600 text-white transition-all">
              üî≤ –°–µ—Ç–∫–∞
            </button>
            <button type="button" id="list-view" class="px-3 py-1 rounded text-sm text-gray-700 hover:text-gray-900 transition-all">
              üìã –°–ø–∏—Å–æ–∫
            </button>
            <button type="button" id="slideshow-view" class="px-3 py-1 rounded text-sm text-gray-700 hover:text-gray-900 transition-all">
              üé¨ –°–ª–∞–π–¥—à–æ—É
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>

  <!-- Loading State -->
  <div id="loading-state" class="text-center py-12 space-card rounded-lg">
    <div class="loading text-blue-600 text-4xl mb-4">üî≠</div>
    <h3 class="text-lg font-semibold text-gray-900">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π JWST...</h3>
    <p class="text-gray-600 mt-2">–ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç —Ç–µ–ª–µ—Å–∫–æ–ø–∞</p>
  </div>

  <!-- Grid View -->
  <div id="gallery-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" style="display: none;">
    <!-- Image Card Template - Will be dynamically populated -->
    <div class="space-card rounded-lg overflow-hidden cursor-pointer" onclick="openFullscreen(0)">
      <div class="aspect-square overflow-hidden">
        <img src="https://jwst-api-cdn.nyc3.cdn.digitaloceanspaces.com/jwst--jw02731001002_02105_00003_nrcalong_o001_crf_thumb.jpg" alt="jw02731001002_02105_00003_nrcalong_o001 ¬∑ P2731 ¬∑ _thumb ¬∑ FGS/NIRCAM/NIRISS/NIRSPEC/MIRI" class="w-full h-full object-cover" loading="lazy">
      </div>
      <div class="p-4">
        <h4 class="text-sm font-semibold text-gray-900 mb-2 line-clamp-2">
          jw02731001002_02105_00003_nrcalong_o001
        </h4>
        <div class="text-xs text-gray-600 space-y-1">
          <div>Program: 2731</div>
          <div>Instruments: FGS, NIRCAM, NIRISS, NIRSPEC, MIRI</div>
          <div>Suffix: _thumb</div>
        </div>
      </div>
    </div>
  </div>

  <!-- List View -->
  <div id="gallery-list" class="space-y-4" style="display: none;">
    <!-- List items will be loaded here -->
  </div>

  <!-- Slideshow View -->
  <div id="slideshow-container" class="space-card rounded-lg p-6" style="display: none;">
    <div class="text-center">
      <div class="relative">
        <img id="slideshow-image" class="mx-auto rounded-lg max-h-96 object-contain" alt="JWST Image">
        <div class="absolute inset-0 flex items-center justify-between p-4">
          <button id="prev-slide" class="p-2 bg-gray-700 bg-opacity-50 rounded-full text-white hover:bg-opacity-75">
            ‚Äπ
          </button>
          <button id="next-slide" class="p-2 bg-gray-700 bg-opacity-50 rounded-full text-white hover:bg-opacity-75">
            ‚Ä∫
          </button>
        </div>
      </div>
      <div id="slideshow-caption" class="mt-4 text-lg font-semibold text-gray-900"></div>
      <div id="slideshow-controls" class="mt-4 flex items-center justify-center space-x-4">
        <button id="play-pause" class="px-4 py-2 bg-blue-100 bg-opacity-50 hover:bg-blue-200 border border-blue-300 rounded text-blue-700">
          ‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏
        </button>
        <span class="text-gray-600">
          <span id="current-slide">1</span> / <span id="total-slides">0</span>
        </span>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div id="empty-state" class="text-center py-12 space-card rounded-lg" style="display: none;">
    <div class="text-6xl mb-4 text-gray-500">üî≠</div>
    <h3 class="text-xl font-semibold text-gray-900 mb-2">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
    <p class="text-gray-600">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤</p>
    <button class="mt-4 px-4 py-2 bg-blue-100 hover:bg-blue-200 border border-blue-300 rounded text-blue-700 transition-all"
            onclick="resetFilters()">
      üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
    </button>
  </div>

  <!-- Pagination -->
  <div id="pagination" class="flex items-center justify-center space-x-2 mt-8" style="display: none;">
    <button id="prev-page" class="px-4 py-2 bg-gray-100 border border-gray-300 rounded text-gray-700 hover:text-gray-900 disabled:opacity-50">
      ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è
    </button>
    <div id="page-info" class="px-4 py-2 text-gray-700">
      –°—Ç—Ä–∞–Ω–∏—Ü–∞ <span id="current-page">1</span> –∏–∑ <span id="total-pages">1</span>
    </div>
    <button id="next-page" class="px-4 py-2 bg-gray-100 border border-gray-300 rounded text-gray-700 hover:text-gray-900 disabled:opacity-50">
      –°–ª–µ–¥—É—é—â–∞—è ‚Üí
    </button>
  </div>
</div>

<!-- Fullscreen Modal -->
<div id="fullscreen-modal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50" style="display: none;">
  <div class="relative w-full h-full flex items-center justify-center p-4">
    <img id="fullscreen-image" class="max-w-full max-h-full object-contain rounded-lg">
    
    <!-- Navigation -->
    <button id="fs-prev" class="absolute left-4 top-1/2 transform -translate-y-1/2 p-3 bg-gray-700 bg-opacity-50 rounded-full text-white hover:bg-opacity-75">
      ‚Äπ
    </button>
    <button id="fs-next" class="absolute right-4 top-1/2 transform -translate-y-1/2 p-3 bg-gray-700 bg-opacity-50 rounded-full text-white hover:bg-opacity-75">
      ‚Ä∫
    </button>
    
    <!-- Close Button -->
    <button id="fs-close" class="absolute top-4 right-4 p-3 bg-gray-700 bg-opacity-50 rounded-full text-white hover:bg-opacity-75 text-2xl">
      ‚úï
    </button>
    
    <!-- Image Info -->
    <div class="absolute bottom-4 left-4 right-4 bg-gray-800 bg-opacity-70 rounded-lg p-4 text-white">
      <h4 id="fs-title" class="font-semibold text-lg mb-2 text-gray-100"></h4>
      <div class="flex items-center justify-between text-sm text-gray-300">
        <span id="fs-details"></span>
        <div class="space-x-2">
          <button id="fs-download" class="px-3 py-1 bg-blue-600 bg-opacity-20 hover:bg-opacity-30 rounded text-blue-400">
            üì• –°–∫–∞—á–∞—Ç—å
          </button>
          <button id="fs-share" class="px-3 py-1 bg-blue-600 bg-opacity-20 hover:bg-opacity-30 rounded text-blue-400">
            üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- All JavaScript Libraries -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" defer></script>

<!-- JWST Gallery Logic -->
<script src="/js/jwst-gallery.js" defer></script>
